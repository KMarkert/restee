
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>Usage - restee Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-restee" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="restee Documentation" class="md-header__button md-logo" aria-label="restee Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            restee Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="restee Documentation" class="md-nav__button md-logo" aria-label="restee Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    restee Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="usage.html" class="md-nav__link md-nav__link--active">
        Usage
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requesting-images" class="md-nav__link">
    Requesting Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requesting-tables" class="md-nav__link">
    Requesting Tables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requesting-values" class="md-nav__link">
    Requesting Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveauts" class="md-nav__link">
    Caveauts
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="core.html" class="md-nav__link">
        core module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="images.html" class="md-nav__link">
        images module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="tables.html" class="md-nav__link">
        tables module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="values.html" class="md-nav__link">
        values module
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requesting-images" class="md-nav__link">
    Requesting Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requesting-tables" class="md-nav__link">
    Requesting Tables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requesting-values" class="md-nav__link">
    Requesting Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveauts" class="md-nav__link">
    Caveauts
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="using-restee">Using restee</h1>
<p>The page serves as more in depth examples of using <code>restee</code> to get data from Earth Engine results. Before walking through these examples, please make sure you have gone throught the <a href="/restee/installation">Installation page</a> and installed everything correctly.</p>
<p>To begin, we will need to import the <code>ee</code> and <code>restee</code> packages. Next, we need to authenticate Earth Engine and create a authenticated cloud session so we can request the data from the server to our local system.</p>
<pre><code class="language-python">import ee
ee.Initialize()

import restee as ree

# get and authenticated cloud session for requesting data
session = ree.EESession(&quot;&lt;CLOUD-PROJECT&gt;&quot;,&quot;&lt;PATH-TO-SECRET-KEY&gt;&quot;)
</code></pre>
<p>Now we are ready to crunch some data!</p>
<h2 id="requesting-images">Requesting Images</h2>
<p>Earth Engines core capabilities come from massive geospatial raster processing. It makes working with and processing imagery much easier but often times, one would like to use the results with some other process. <code>restee</code> allows for users to request processed imagery to local data structures such as</p>
<pre><code class="language-python">states = ee.FeatureCollection('TIGER/2018/States')
maine = states.filter(ee.Filter.eq('NAME', 'Maine'))

# get a domain for the state of Maine at ~500m resolution
domain = ree.Domain.from_ee_geometry(session, maine, resolution=0.005)

imshow(domain.mask)
</code></pre>
<p><img alt="Maine domain" src="img/domain_example.png" /></p>
<p>Now that we have a domain we can use that to control where on the globe we request imagery. Here we simply grab the first image in the MOD13Q1 NDVI collection and request the data for Maine.</p>
<pre><code class="language-python"># get an ee.Image object
img = (
    ee.ImageCollection('MODIS/006/MOD13Q1')
    .select(&quot;NDVI&quot;)
    .first()
)

# request the image as an np.ndarray using the domain
ndvi_arr = ree.img_to_ndarray(session,domain,img)

# inspect the data structure of ndvi_arr
ndvi_arr

# array([[( 3905,), ( 3880,), ( 2823,), ..., ( 2522,), ( 1714,), ( 1714,)],
#        [( 3605,), ( 3447,), ( 3447,), ..., ( 3845,), ( 2324,), ( 2324,)],
#        [( 3399,), ( 3315,), ( 3315,), ..., ( 4584,), ( 2238,), ( 2238,)],
#        ...,
#        [( 5711,), ( 5611,), ( 4905,), ..., (-3000,), (-3000,), (-3000,)],
#        [( 4845,), ( 4791,), ( 4606,), ..., (-3000,), (-3000,), (-3000,)],
#        [( 5101,), ( 4443,), ( 4610,), ..., (-3000,), (-3000,), (-3000,)]],
#       dtype=[('NDVI', '&lt;i2')])
</code></pre>
<p>The resulting numpy array is the raw data from EE for the region and projected in the coordiates defined by <code>domain</code>. The <code>restee.img_to_ndarray</code> only returns a structured array of pixel values. To request data while retaining the geographic information, please see the <a href="/images/#restee.images.img_to_xarray"><code>restee.img_to_xarray</code></a> function.</p>
<p>We can not only request individual images but also an ImageCollection over a region. To do this, the ImageCollection needs to have a <code>system:time_start</code> property (this is important when doing some computations as EE drops metadata properties). We will use the Maine example again, however, this time request the first ten images in the collection as a xarray.Dataset which allows us to manage the time dimension</p>
<pre><code># grab the first 10 NDVI images from a MODIS collection
ic = (
    ee.ImageCollection('MODIS/006/MOD13Q1')
    .limit(10,&quot;system:time_start&quot;)
    .select(&quot;NDVI&quot;)
)

ds_ndvi = ree.imgcollection_to_xarray(session,domain,ic,no_data_value=0,verbose=True)

# plot the results
ds_ndvi.where(ds_ndvi.NDVI&gt;=0).NDVI.plot(col='time',col_wrap=5,robust=True,cmap='Greens')
</code></pre>
<p><img alt="MODIS NDVI Timeseries" src="img/imgcollection_example.png" /></p>
<p>This function is handy as it allows for geographic as well as time information to be retained.</p>
<p>It is planned to allow users to define an ImageCollection by other properties than <code>system:time_start</code>, however, since ImageCollections are most often time based this functionality should serve most purposes.</p>
<h2 id="requesting-tables">Requesting Tables</h2>
<p>Imagery is not the only thing that Earth Engine can process. There are many vector based workflows that are useful on Earth Engine such as sampling values from an image or calculating zonal statistics. To access computed a computed feature or feature collection, <code>restee</code> has methods to request the data in a local table structure.</p>
<p>In this example, we will calculate the average NDVI from a MODIS image for the countries in Southeast Asia:</p>
<pre><code class="language-python">countries = ee.FeatureCollection(&quot;USDOS/LSIB_SIMPLE/2017&quot;)
seasia = countries.filter(ee.Filter.eq(&quot;wld_rgn&quot;, &quot;SE Asia&quot;))

computation = img.reduceRegions(
    collection=seasia,
    reducer=ee.Reducer.mean().setOutputs([&quot;NDVI&quot;]),
    scale=1000
)

gdf = ree.features_to_geodf(session,computation)

gdf.plot(column=&quot;NDVI&quot;,cmap=&quot;Greens&quot;)
</code></pre>
<p><img alt="SE Asia NDVI" src="img/table_example.png" /></p>
<p>Not all computed ee.Feature or ee.FeatureCollections have geometry information, to support the lack of geometry data, <code>restee</code> also has a function <a href="/restee/tables/#restee.features_to_df"><code>restee.features_to_df</code></a> to request the data as a <code>pandas.DataFrame</code>.</p>
<h2 id="requesting-values">Requesting Values</h2>
<p>Not all information from Earth Engine is a spatial computation. Sometimes calculating statistics or reading metadata from the image/collections is needed. We can request essentially any ee.ComputedObject to a local Python data type and continue using on our local system.</p>
<p>Here is a quick example of getting a list of dates from an image collection:</p>
<pre><code>ic = (
    ee.ImageCollection('MODIS/006/MOD13Q1')
    .limit(10,&quot;system:time_start&quot;)
    .select(&quot;NDVI&quot;)
)

# compute the string format of the image dates
ee_dates = (
    ic.aggregate_array(&quot;system:time_start&quot;)
    .map(lambda x: ee.Date(x).format(&quot;YYYY-MM-dd HH:mm:ss&quot;))
)

# get this list of date strings
dates = ree.get_value(session, ee_dates)

dates
# output 
# ['2000-02-18 00:00:00',
#  '2000-03-05 00:00:00',
#  '2000-03-21 00:00:00',
#  '2000-04-06 00:00:00',
#  '2000-04-22 00:00:00',
#  '2000-05-08 00:00:00',
#  '2000-05-24 00:00:00',
#  '2000-06-09 00:00:00',
#  '2000-06-25 00:00:00',
#  '2000-07-11 00:00:00']
</code></pre>
<p>The <code>restee.get_value</code> function takes essentially any ee.ComputedObject (such as ee.List, ee.Array, ee.Dictionary, ee.String)and will convert it to the Python equivalent for use locally.</p>
<h2 id="caveauts">Caveauts</h2>
<p>There is a limit to how much data/computations you can request. Typically this manifests itself in 500 error. Please note that this is an Earth Image limit and has little to do with <code>restee</code>.</p>
<p>Please refer to the <a href="https://developers.google.com/earth-engine/reference#quota-and-limits">Quotas and Limits section</a> of the REST API documentation to learn more.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="installation.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="core.html" class="md-footer__link md-footer__link--next" aria-label="Next: core module" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              core module
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.76f349be.min.js"></script>
      
    
  </body>
</html>